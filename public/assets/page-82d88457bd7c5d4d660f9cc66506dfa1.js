$(function(){var a=200;$("li.submission").draggable({handle:"span.drag-handle-wrap",zIndex:1,helper:function(){var b=$(this).find("header h2").clone().text();return b.length>20&&(b=b.substring(0,20)+"&hellip;"),$('<h2 class="nocaps"></h2>').html(b).css({width:a})},cursorAt:{left:a/2,top:-10},drag:function(a,b){b.position.left=a.pageX+15}}),$("li.page").droppable({hoverClass:"drop-here",drop:function(a,b){var c=b.draggable,d=c.attr("id").split("_").pop(),e=$(this).text(),f=window.location.pathname.split("/"),g=f.splice(3,1,e);f=f.join("/"),console.info("Moving submission "+d+" to "+f),$.ajax({type:"PUT",dataType:"script",url:f+"/add_submission",data:{submission_id:d},beforeSend:function(a,b){c.css("border-style","dotted")},success:function(a,b,d){e==g?c.css("border-style","dashed").parents("ol").prepend(c):c.hide()},error:function(a,b,d){c.addClass("error").removeAttr("style")}})}})})