%li[magazine]
  .cover-art
    - if magazine.try(:cover_art?)
      = link_to [magazine], class: 'img' do
        = image_tag magazine.cover_art.url(:thumb), alt: ""
    %header
      %h2
        = magazine.published? ? link_to(magazine, [magazine]) : magazine
      = link_to "Download PDF", magazine.pdf.url, 'data-target' => 'new' if magazine.pdf?
      = link_to "View meetings", meetings_path(m: magazine.id) if staff? || editor?
    %span.timeframe
      - if magazine.published?
        Published on
        %time{ :datetime => magazine.published_on }= pretty_date(magazine.published_on)
      - elsif magazine.accepts_submissions_until < Time.now
        = timeframe(magazine.accepts_submissions_from, magazine.accepts_submissions_until)
      - else
        Submit by #{pretty_date(magazine.accepts_submissions_until)}
    - if editor?
      .small.sans.right
        = link_to "&nbsp;/".html_safe, edit_magazine_url(magazine), title: 'Edit'
        = button_to "x", magazine_url(magazine),
          method: :delete,
          confirm: "You're saying this magazine never actually happened. All of its meetings will be unassociated with any magazine. If this magazine has been published, all of the submissions submitted for it will be simply \"Scored\" again.",
          class: 'link destroy',
          title: "Delete"
  - if editor? && (magazine.accepts_submissions_until < Time.now && magazine.published_on == nil)
    %div= link_to "View the highest-scored submissions", highest_scored_for_magazine_path(magazine)
